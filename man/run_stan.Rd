% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/modele.R
\name{run_stan}
\alias{run_stan}
\title{Run Hierarchical Bayesian Model with rstan}
\usage{
run_stan(data = data, iter = 2000, chains = 4, thinning = 1)
}
\arguments{
\item{data}{clean generated by creation_df()}

\item{iter}{Integer. Total number of MCMC iterations per chain (including warmup). Default is 2000.}

\item{chains}{Integer. Number of MCMC chains. Default is 4.}

\item{thinning}{Integer. Thinning interval for posterior samples. Default is 1.}
}
\value{
A named list containing:
\describe{
  \item{`fit`}{An `rstan` `stanfit` object with the fitted model and posterior samples.}
  \item{`species_complex`}{Data frame or vector linking species to complexes used in the model.}
  \item{`nice_varname`}{User-friendly variable name for labeling and plotting.}
  \item{`varname`}{The original variable name input.}
  \item{`iter`}{Number of iterations used in sampling.}
  \item{`warmup`}{Number of warmup (burn-in) iterations.}
  \item{`thinning`}{Thinning interval applied during sampling.}
}
}
\description{
Loads, filters, and formats data, then compiles and runs a hierarchical Bayesian binomial model
using Stan. The model estimates species-level proportions within species complexes,
accounting for hierarchical structure and covariates such as region and year.
}
\details{
The function calls `creation_df()` to filter and preprocess the data,
then prepares Stan-compatible data using `prepare_stan_data()`.
The Stan model file `"Hierarchical_Model.stan"` is loaded from the package directory,
compiled, and sampled with specified MCMC parameters.
Recommended control parameters `adapt_delta = 0.99` and `max_treedepth = 15` improve convergence.
Warmup is set to 20% of total iterations by default.
}
