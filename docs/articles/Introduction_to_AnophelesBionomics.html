<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction_to_AnophelesBionomics • AnophelesBionomics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction_to_AnophelesBionomics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AnophelesBionomics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Introduction_to_AnophelesBionomics.html">Introduction_to_AnophelesBionomics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><link href="Introduction_to_AnophelesBionomics_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="Introduction_to_AnophelesBionomics_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="Introduction_to_AnophelesBionomics_files/plotly-binding-4.11.0/plotly.js"></script><script src="Introduction_to_AnophelesBionomics_files/typedarray-0.1/typedarray.min.js"></script><link href="Introduction_to_AnophelesBionomics_files/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="Introduction_to_AnophelesBionomics_files/crosstalk-1.2.1/js/crosstalk.min.js"></script><link href="Introduction_to_AnophelesBionomics_files/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="Introduction_to_AnophelesBionomics_files/plotly-main-2.11.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction_to_AnophelesBionomics</h1>
            
      

      <div class="hidden name"><code>Introduction_to_AnophelesBionomics.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">AnophelesBionomics</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This R package provides tools to estimate key bionomics parameters
for mosquitoe species using a Bayesian hierarchical model that borrows
strength across taxonomic levels (species, species complex, and
genus).</p>
<p>We prepare and standardize the input data using taxonomy-aware
filtering functions. We then fit a robust Bayesian hierarchical model
using rstan. To better understand the observed patterns, we visualize
data distributions by species and complex. Finally, we explore the
posterior parameter distributions using static density plots generated
with ggplot2, as well as interactive charts built with plotly for more
intuitive inspection.</p>
<p>Even when species-specific data is missing, the model can infer
parameter values using information from related taxa, thanks to
taxonomic structure. The approach combines internal datasets included in
the package user-provided external data The estimation relies on the
No-U-Turn Sampler (NUTS) implemented via rstan, and includes tools for
data preparation, posterior diagnostics, and interactive
visualization.</p>
<p>The model focuses on estimating the following mosquito-related
parameters:</p>
<ul>
<li><p><strong><code>parous_rate</code></strong>: Proportion of
previously blood-fed female mosquitoes.</p></li>
<li><p><strong><code>endophagy</code></strong>: Proportion of mosquitoes
biting indoors versus outdoors.</p></li>
<li><p><strong><code>endophily</code></strong>: Proportion of mosquitoes
resting indoors after feeding.</p></li>
<li><p><strong><code>HBI</code></strong>: Human blood index.</p></li>
<li><p><strong><code>indoor_HBI</code></strong>: Human blood index for
mosquitoes collected indoors</p></li>
<li><p><strong><code>outdoor_HBI</code></strong>: Human blood index for
mosquitoes collected outdoors.</p></li>
<li><p><strong><code>sac_rate</code></strong>: Proportion of
sac.</p></li>
</ul>
<p>The necessary and optional packages required to run the package are
listed in the appendix.</p>
<p><br><br><br><br></p>
</div>
<div class="section level2">
<h2 id="how-to-use-the-package">How to use the package<a class="anchor" aria-label="anchor" href="#how-to-use-the-package"></a>
</h2>
<div class="section level3">
<h3 id="adding-and-cleaning-data">Adding and cleaning Data<a class="anchor" aria-label="anchor" href="#adding-and-cleaning-data"></a>
</h3>
<p>The creation_df() function is designed to preprocess raw
entomological data for Bayesian modeling of mosquito bionomic traits. To
use it, the user simply specifies the variable of interest — such as
Human Blood Index (HBI), endophagy, or endophily — via the varname
argument. This variable corresponds to a specific mosquito bionomics</p>
<p>For basic use, only varname is required:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/creation_df.html">creation_df</a></span><span class="op">(</span><span class="st">"endophily"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Total observations: 38"</span></span>
<span><span class="co">#&gt; [1] "denominator is always larger or equal to numerator: good!"</span></span></code></pre></div>
<p>When executed, the function returns informative messages in the
console : it reports the number of observations retained after filtering
(e.g., “Total observations: 90”) and verifies the internal consistency
of the data structure by checking that denominators are always greater
than or equal to numerators in proportion calculations (e.g.,
“denominator is always larger or equal to numerator: good!”). These
checks help ensure data integrity before downstream analysis.</p>
<p>Optionally, users can apply geographic and temporal filters to refine
the dataset. The geo parameter allows restriction to specific regions.
Available region codes are “Africa-E” (Eastern Africa), “Africa-W”
(Western Africa), “Americas”, “Asia-Pacific”, and NA for unspecified or
global studies. The year_min and year_max parameters allow filtering by
study period, based on the year of data collection:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/creation_df.html">creation_df</a></span><span class="op">(</span>varname <span class="op">=</span> <span class="st">"parous_rate"</span>,</span>
<span>                    geo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Africa-W"</span>, <span class="st">"Americas"</span><span class="op">)</span>,</span>
<span>                    year_min <span class="op">=</span> <span class="fl">1900</span>,</span>
<span>                    year_max <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Total observations: 226"</span></span>
<span><span class="co">#&gt; [1] "denominator is always larger or equal to numerator: good!"</span></span></code></pre></div>
<p>Internally, the function filters the dataset according to the
selected region(s) and time period, extracts the relevant observations
for the chosen bionomic parameter, and calculates proportions as needed.
It excludes studies not suitable for behavioral inference, handles data
from insecticide intervention contexts, and harmonizes mosquito species
names. Species are also grouped into complexes when appropriate,
enabling hierarchical modeling.</p>
<p>In addition to using internal data, users can also integrate their
own external dataset by supplying it through the extern_data argument.
This allows appending custom observations to the internal database
before preprocessing. The external data must match the internal
structure in terms of column names and data types. The rules for
formatting this external dataset are provided in the Appendix.</p>
<p>Here’s a minimal working example of external data for the parous_rate
trait:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extern_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Anopheles arabiensis"</span>, <span class="st">"Anopheles arabiensis"</span><span class="op">)</span>,</span>
<span>  insecticide_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"f"</span>, <span class="st">"f"</span><span class="op">)</span>,</span>
<span>  country <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Benin"</span>, <span class="st">"Benin"</span><span class="op">)</span>,</span>
<span>  year_start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2010</span>, <span class="fl">2012</span><span class="op">)</span>,</span>
<span>  parity_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">30</span><span class="op">)</span>,</span>
<span>  parity_total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">60</span><span class="op">)</span>,</span>
<span>  parity_percent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>You can include this data in the main function call as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/creation_df.html">creation_df</a></span><span class="op">(</span>varname <span class="op">=</span> <span class="st">"parous_rate"</span>,</span>
<span>                    geo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Africa-W"</span>, <span class="st">"Americas"</span><span class="op">)</span>,</span>
<span>                    year_min <span class="op">=</span> <span class="fl">1900</span>,</span>
<span>                    year_max <span class="op">=</span> <span class="fl">2020</span>, extern_data <span class="op">=</span> <span class="va">extern_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Total observations: 228"</span></span>
<span><span class="co">#&gt; [1] "denominator is always larger or equal to numerator: good!"</span></span></code></pre></div>
<p>The external data is automatically combined with the internal dataset
during preprocessing. If some required columns are missing in
extern_data, the function will still run but will exclude those external
data rows missing necessary columns, and it will display a message
specifying which columns were missing. This allows the internal data to
be processed normally while warning the user about incomplete external
data.</p>
<p>Make sure your dataset follows the expected structure (see Appendix
for a complete column specification) to ensure full integration of your
external observations.</p>
<p>The output is a named list containing four elements: (1) data.req,
the fully cleaned and filtered dataset, (2) nice_varname, a
human-readable label suitable for outputs, (3) species_complex, a
reference table mapping species and species complexes to numeric
identifiers, and (4) varname, the name of the selected mosquito bionomic
parameter.</p>
<p>This function ensures consistent and reproducible preparation of
entomological data, focusing on a single mosquito trait per run, and is
optimized for integration into Bayesian analysis pipelines.</p>
<p><br><br><br></p>
</div>
<div class="section level3">
<h3 id="data-visualisation">Data Visualisation<a class="anchor" aria-label="anchor" href="#data-visualisation"></a>
</h3>
<p>The function obs_complex_species_pie() allows users to visualize the
distribution of mosquito observations by species or species complex
through an interactive pie chart. The function calculates observation
proportions and consolidates species with very low representation into
an “Other” category based on a user-defined threshold. Additionally, the
resulting visualization can be saved as a standalone HTML file if a
directory is specified.</p>
<p>When hovering over a slice, detailed information is displayed,
including the species or complex name, the total number of observations,
the number of survey rows, the mean and standard deviation of the
observed values, and the proportion of the total.</p>
<p>This function expects as input a list structured as the output of the
creation_df() function, which contains a cleaned data frame with
observation counts identified by a variable name pattern, the base name
of the variable, and a user-friendly label for output naming. The user
can adjust the minimum proportion threshold that determines when rare
species are grouped together. For example, setting this threshold to
0.05 ensures that only species representing at least 5% of observations
are shown individually. Finally the user can chose a path in order to
save his pie. For instance, after preparing the data using the
preprocessing pipeline, a user might call:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/obs_complex_species_pie.html">obs_complex_species_pie</a></span><span class="op">(</span><span class="va">data</span>, threshold_prop_other <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proportion de la catégorie 'Other' : 3.08%</span></span></code></pre></div>
<div class="plotly html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:768px;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"visdat":{"354454e71fce":["function () ","plotlyVisDat"]},"cur_data":"354454e71fce","attrs":{"354454e71fce":{"labels":{},"values":{},"textposition":"outside","text":{},"hoverinfo":"text","texttemplate":{},"insidetextorientation":"radial","marker":{"colors":["#B956DD","#C7A5ED","#DB92E1","#C0ED49","#CCCCCC","#3D565F","#E34C39","#9CAEE6"],"line":{"color":"#FFFFFF","width":1}},"textfont":{"size":20,"family":"Arial"},"domain":{"x":[0.29999999999999999,0.69999999999999996],"y":[0.40000000000000002,0.80000000000000004]},"direction":"counterclockwise","rotation":120,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"pie"}},"layout":{"margin":{"b":0,"l":60,"t":25,"r":10},"annotations":[{"text":"<b>Parous rate<\/b>","x":0.5,"y":0.20999999999999999,"xanchor":"center","yanchor":"bottom","showarrow":false,"font":{"size":25,"family":"Arial","color":"black"},"xref":"paper","yref":"paper"}],"showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"labels":["Complex: Albitarsis","Complex: Funestus","Complex: Gambiae","Complex: Nili","Other","Species: Anopheles funestus","Species: Anopheles gambiae s.s.","Species: Anopheles moucheti"],"values":[3081,5912,36492,4579,2347,2452,17556,3797],"textposition":["outside","outside","outside","outside","outside","outside","outside","outside"],"text":["Complex: Albitarsis<br>Number of observations (sum): 3081<br>Number of surveys (rows): 1<br>Mean value: 0.47<br>SD value: NA<br>Proportion: 4%","Complex: Funestus<br>Number of observations (sum): 5912<br>Number of surveys (rows): 28<br>Mean value: 0.82<br>SD value: 0.11<br>Proportion: 7.8%","Complex: Gambiae<br>Number of observations (sum): 36492<br>Number of surveys (rows): 110<br>Mean value: 0.69<br>SD value: 0.22<br>Proportion: 47.9%","Complex: Nili<br>Number of observations (sum): 4579<br>Number of surveys (rows): 14<br>Mean value: 0.83<br>SD value: 0.13<br>Proportion: 6%","Other<br>Number of observations (sum): 2347<br>Number of surveys (rows): 9<br>Mean value: 0.45<br>SD value: NA<br>Proportion: 3.1%","Species: Anopheles funestus<br>Number of observations (sum): 2452<br>Number of surveys (rows): 26<br>Mean value: 0.72<br>SD value: 0.19<br>Proportion: 3.2%","Species: Anopheles gambiae s.s.<br>Number of observations (sum): 17556<br>Number of surveys (rows): 37<br>Mean value: 0.69<br>SD value: 0.16<br>Proportion: 23%","Species: Anopheles moucheti<br>Number of observations (sum): 3797<br>Number of surveys (rows): 3<br>Mean value: 0.71<br>SD value: 0.05<br>Proportion: 5%"],"hoverinfo":["text","text","text","text","text","text","text","text"],"texttemplate":["Complex: Albitarsis · 4%","Complex: Funestus · 8%","Complex: Gambiae · 48%","Complex: Nili · 6%","Other · 3%","Species: Anopheles funestus · 3%","Species: Anopheles gambiae s.s. · 23%","Species: Anopheles moucheti · 5%"],"insidetextorientation":"radial","marker":{"color":"rgba(31,119,180,1)","colors":["#B956DD","#C7A5ED","#DB92E1","#C0ED49","#CCCCCC","#3D565F","#E34C39","#9CAEE6"],"line":{"color":"#FFFFFF","width":1}},"textfont":{"size":20,"family":"Arial"},"domain":{"x":[0.29999999999999999,0.69999999999999996],"y":[0.40000000000000002,0.80000000000000004]},"direction":"counterclockwise","rotation":120,"type":"pie","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Similarly, obs_region_pie() generates an interactive pie chart
displaying the geographic distribution of mosquito observations. It
calculates proportional contributions from regions and labels missing
regions as “Unspecified”.</p>
<p>This function also takes as input a list matching the structure
returned by creation_df(), ensuring consistent data formatting.For
instance, after preparing the data using the preprocessing pipeline, a
user might call:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/obs_region_pie.html">obs_region_pie</a></span><span class="op">(</span><span class="va">data</span>,</span>
<span>                plot_dir <span class="op">=</span> <span class="st">"path/to/save/directory/"</span><span class="op">)</span></span></code></pre></div>
<p>Both functions produce interactive Plotly charts that facilitate
exploratory data analysis and can be seamlessly integrated into
reporting workflows.</p>
<p><br><br><br></p>
</div>
<div class="section level3">
<h3 id="to-build-the-model">To build the model<a class="anchor" aria-label="anchor" href="#to-build-the-model"></a>
</h3>
<p>The function run_stan() performs hierarchical Bayesian binomial
modeling using the rstan package to estimate the distribution of a
binary trait, such as Human Blood Index or endophagy, across mosquito
species and species complexes. It executes the complete modeling
workflow, which includes preparing data in a format compatible with Stan
via the prepare_stan_data() function, compiling the Stan model, and
conducting sampling.</p>
<p>By default, the model runs with 2000 iterations per chain, including
a warmup (burn-in) period of 400 iterations, distributed over four
independent chains. These parameters — including the total number of
iterations, the number of chains, and the thinning interval applied to
posterior samples — can be customized by the user to control the length
and quality of the sampling process.</p>
<p>The input data must be a cleaned dataset structured as the output
from the creation_df() function, containing all necessary variables,
including species and complex identifiers, required for model
fitting.</p>
<p>Upon completion, the function returns a named list containing several
components. The most important of these is the fit element, which is a
stanfit object representing the fitted model. This object provides
access to posterior distributions of estimated parameters, allowing
detailed inspection of species- and complex-level effects. For example,
if the function is called as</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">run_stan_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_stan.html">run_stan</a></span><span class="op">(</span><span class="va">data</span>, iter <span class="op">=</span> <span class="fl">1000</span>, chains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 8.2e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.82 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 201 / 1000 [ 20%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 300 / 1000 [ 30%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 400 / 1000 [ 40%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 500 / 1000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 2.118 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                4.119 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                6.237 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Gradient evaluation took 3.6e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.36 seconds.</span></span>
<span><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 201 / 1000 [ 20%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 300 / 1000 [ 30%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 400 / 1000 [ 40%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 500 / 1000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2:  Elapsed Time: 1.372 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 2:                1.165 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2:                2.537 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: Gradient evaluation took 3.3e-05 seconds</span></span>
<span><span class="co">#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.33 seconds.</span></span>
<span><span class="co">#&gt; Chain 3: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3: Iteration:   1 / 1000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 100 / 1000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 200 / 1000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 201 / 1000 [ 20%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 300 / 1000 [ 30%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 400 / 1000 [ 40%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 500 / 1000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 600 / 1000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 700 / 1000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 800 / 1000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 900 / 1000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: Iteration: 1000 / 1000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3: </span></span>
<span><span class="co">#&gt; Chain 3:  Elapsed Time: 1.185 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 3:                2.098 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 3:                3.283 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 3:</span></span>
<span><span class="co">#&gt; Warning: There were 5 divergent transitions after warmup. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span></span>
<span><span class="co">#&gt; to find out why this is a problem and how to eliminate them.</span></span>
<span><span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></span></code></pre></div>
<p>the summary of the fitted model parameters can be viewed using</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">run_stan_result</span><span class="op">$</span><span class="va">fit</span></span>
<span><span class="va">summary_stats</span> <span class="op">&lt;-</span> <span class="fu">rstan</span><span class="fu">::</span><span class="fu">summary</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">$</span><span class="va">summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summary_stats</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  mean     se_mean        sd       2.5%         25%         50%</span></span>
<span><span class="co">#&gt; beta0     0.242517674 0.010188229 0.2707409 -0.2325045  0.04956901  0.21805878</span></span>
<span><span class="co">#&gt; beta1[1]  0.264495972 0.036804969 0.8847219 -1.4206958 -0.20620681  0.20570530</span></span>
<span><span class="co">#&gt; beta1[2]  0.021394340 0.009259912 0.3645550 -0.6723455 -0.21376572  0.01224399</span></span>
<span><span class="co">#&gt; beta1[3] -0.002061972 0.010614368 0.3618285 -0.6914079 -0.23164229 -0.01262263</span></span>
<span><span class="co">#&gt; beta1[4]  0.741534275 0.016675525 0.4083403 -0.0911462  0.48425768  0.76904928</span></span>
<span><span class="co">#&gt; beta1[5]  0.919185912 0.015601075 0.3376903  0.1271790  0.73218132  0.96572101</span></span>
<span><span class="co">#&gt;                75%     97.5%     n_eff      Rhat</span></span>
<span><span class="co">#&gt; beta0    0.4118828 0.7961600  706.1720 1.0010189</span></span>
<span><span class="co">#&gt; beta1[1] 0.7001469 2.1272757  577.8308 1.0040190</span></span>
<span><span class="co">#&gt; beta1[2] 0.2474174 0.7569739 1549.9308 0.9995769</span></span>
<span><span class="co">#&gt; beta1[3] 0.2106222 0.7482801 1162.0300 1.0012850</span></span>
<span><span class="co">#&gt; beta1[4] 1.0137346 1.4545290  599.6330 1.0049012</span></span>
<span><span class="co">#&gt; beta1[5] 1.1464329 1.4693422  468.5199 1.0087756</span></span></code></pre></div>
<p>Other returned elements include a mapping of species to species
complexes, user-friendly and original variable names, and details about
the sampling parameters used. These additional outputs are primarily
intended to support downstream functions responsible for displaying and
further analyzing the model results.</p>
<p><br><br><br></p>
</div>
<div class="section level3">
<h3 id="visualizing-posterior-densities-by-species-complex-plot_density">Visualizing Posterior Densities by Species Complex:
plot_density()<a class="anchor" aria-label="anchor" href="#visualizing-posterior-densities-by-species-complex-plot_density"></a>
</h3>
<p>The plot_density() function is used to visualize the posterior
distributions of model parameters after fitting a hierarchical Bayesian
model via run_stan(). It generates smooth density plots that summarize
the uncertainty associated with each estimated parameter, grouped by
taxonomic level—namely genus, species complex, and individual species.
These visual summaries provide an intuitive and interpretable view of
the model outputs across mosquito taxa.</p>
<p>The function expects as input the full named list returned by
run_stan(), which includes the fitted Stan model object (fit), the
mapping between individual species and their associated complexes
(species_complex), and a user-friendly variable label (nice_varname)
used for titling and file naming. Line styles are used to distinguish
between taxonomic levels: dotted lines for genus-level parameters,
long-dashed lines for species complexes, and solid lines for individual
species. Colors are drawn from a predefined palette, with a fallback to
default colors and warnings if certain groups are not defined.</p>
<p>Users can optionally filter the visualization to include only
specific species complexes by supplying a vector to the complex_names
argument. Parameters labeled with “unlabel” can be excluded using the
unlabel = TRUE option. If desired, the final plot can also be saved as a
PNG file by specifying a valid path via the plot_dir argument.</p>
<p>For example, assuming the model has already been fitted and stored in
an object called stan_result, the density plot can be generated and
saved using the following code:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_density.html">plot_density</a></span><span class="op">(</span>stan_results <span class="op">=</span> <span class="va">run_stan_result</span>,</span>
<span>             complex_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gambiae"</span>, <span class="st">"Funestus"</span><span class="op">)</span>,</span>
<span>             unlabel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in get_plot_component(plot, "guide-box"): Multiple components found;</span></span>
<span><span class="co">#&gt; returning the first one. To return all, use `return_all = TRUE`.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="Introduction_to_AnophelesBionomics_files/figure-html/unnamed-chunk-5-1.png" width="864"></p>
<p>The funciton return a combined <code>ggplot</code> object containing
posterior density plots by species complex with a shared legend. If
<code>plot_dir</code> is specified, the plot is saved as a PNG image
file.</p>
<p><br><br><br></p>
</div>
<div class="section level3">
<h3 id="extracting-posterior-summary-statistics">Extracting Posterior Summary Statistics<a class="anchor" aria-label="anchor" href="#extracting-posterior-summary-statistics"></a>
</h3>
<p>The function species_complex_result() extracts and summarizes
posterior statistics from the hierarchical Bayesian model fitted using
run_stan(). It organizes the posterior samples by taxonomic level—genus,
species complex, and species—and produces a tidy data frame ready for
analysis or reporting.</p>
<p>The summary includes formatted posterior estimates with confidence
intervals, variance measures, and hierarchical metadata. An important
feature is the option to set all = TRUE, which enables supplementation
of missing species or complexes using an external compatibility
taxonomy. In this case, for species without direct data but associated
with a species complex for which data exist, the function uses the
complex-level estimates. If no data are available at the complex level,
the genus-level estimates are used instead. This hierarchical borrowing
of information ensures more complete coverage.</p>
<p>Two flags in the output help track this process: the data flag is set
to TRUE if the estimate is derived from original observed data, and
FALSE otherwise. The source_flag indicates the level at which the
parameter estimate was taken—whether directly from species-level data,
species complex, genus, or supplemented externally.</p>
<p>The function expects as input the full named list output from
run_stan(), including the fitted Stan model (fit), the
species-to-complex mapping (species_complex), and the original variable
name (varname). Users can specify the confidence level for interval
estimation, and optionally save the results as a CSV file by providing
an output directory.</p>
<p>For example, assuming the fitted model results are stored in an
object called stan_result, the posterior summaries can be extracted
with:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/species_complex_result.html">species_complex_result</a></span><span class="op">(</span>results <span class="op">=</span> <span class="va">run_stan_result</span>,</span>
<span>                                       ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>                                       all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">summary_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   name   level              estimate_ci     variance  ci_lower</span></span>
<span><span class="co">#&gt; 1            Anopheles   genus 55.52% ± 36.06% (CI 95%) 3.013295e-02 0.1945526</span></span>
<span><span class="co">#&gt; 2             Funestus complex 71.03% ± 17.86% (CI 95%) 5.024724e-03 0.5317520</span></span>
<span><span class="co">#&gt; 3              Gambiae complex 58.89% ± 11.84% (CI 95%) 3.201060e-03 0.4705926</span></span>
<span><span class="co">#&gt; 4 Anopheles arabiensis species   48.99% ± 7.8% (CI 95%) 1.611226e-03 0.4131630</span></span>
<span><span class="co">#&gt; 5   Anopheles darlingi species  46.65% ± 3.23% (CI 95%) 2.685148e-04 0.4342010</span></span>
<span><span class="co">#&gt; 6   Anopheles funestus species  75.66% ± 1.76% (CI 95%) 7.674926e-05 0.7390068</span></span>
<span><span class="co">#&gt;    ci_upper                    complex data source_flag</span></span>
<span><span class="co">#&gt; 1 0.8935260                       &lt;NA&gt; TRUE          NA</span></span>
<span><span class="co">#&gt; 2 0.8129574                       &lt;NA&gt; TRUE          NA</span></span>
<span><span class="co">#&gt; 3 0.6928048                       &lt;NA&gt; TRUE          NA</span></span>
<span><span class="co">#&gt; 4 0.5679127                    Gambiae TRUE          NA</span></span>
<span><span class="co">#&gt; 5 0.4987999 Anopheles darlingi_complex TRUE          NA</span></span>
<span><span class="co">#&gt; 6 0.7731687                   Funestus TRUE          NA</span></span></code></pre></div>
<p>This call produces a comprehensive table including credible intervals
and variance estimates for each taxonomic group, borrowing information
hierarchically where data are missing, and saves the result as a CSV
file. The resulting data frame can then be used for further analysis,
visualization, or reporting purposes.</p>
<p>In order to have the correct output for the Packae Anophles model, we
have The function Bionomics_For_Anophles_Model(). It wraps and extends
the logic of species_complex_result(), applying it sequentially to five
core bionomic traits: Parous rate (M, M.sd), Endophagy (endophagy,
endophagy.sd), Endophily (endophily, endophily.sd), sac rate (A0,
A0.sd), human blood index (HBI) (Chi, )</p>
<p>Internally, for each of these parameters, the fonction prepares the
data using creation_df(), runs the hierarchical Bayesian model with
run_stan() and extracts posterior summaries via the internal function
species_complex_result(). However, you don’t need to call any of these
steps individually: Bionomics_For_Anophles_Model() automates the entire
workflow. The resulting table aggregates posterior means and variances
into a single, tidy data frame.</p>
<p>The function automatically standardizes species and complex names to
ensure compatibility with the structure expected by the AnophelsModel
package. This includes renaming known variants (e.g., ‘Anopheles gambiae
s.s.’ → ‘Anopheles gambiae’ → ‘Gambiae complex’) and inserting a
synthetic row for the ‘Jamesii complex’.</p>
<p>To use it, run:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bionomics_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/Bionomics_For_Anophles_Model.html">Bionomics_For_Anophles_Model</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bionomics_df</span><span class="op">)</span></span></code></pre></div>
<p>The output format is specifically designed to plug directly into
AnophelsModel, Note: the output currently lacks the following columns
required for full compatibility with AnophelsModel: zeta.3, td, tau, ts,
and to. These parameters are not estimated by the current hierarchical
model and should be added manually or completed through another
estimation source if full model input is needed.</p>
<p><br><br><br></p>
</div>
<div class="section level3">
<h3 id="dashboard">Dashboard<a class="anchor" aria-label="anchor" href="#dashboard"></a>
</h3>
<p>TO DO</p>
<p><br><br><br></p>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="packages-use-in-anophelesbionomics">1. Packages use in AnophelesBionomics<a class="anchor" aria-label="anchor" href="#packages-use-in-anophelesbionomics"></a>
</h3>
<div class="section level4">
<h4 id="required-packages">Required Packages<a class="anchor" aria-label="anchor" href="#required-packages"></a>
</h4>
<p>The following packages are required for the core functionalities of
the package:</p>
<ul>
<li>stats</li>
<li>dplyr</li>
<li>ggplot2</li>
<li>rstan</li>
<li>plotly</li>
<li>utils</li>
<li>coda</li>
</ul>
</div>
<div class="section level4">
<h4 id="optional-packages">Optional Packages<a class="anchor" aria-label="anchor" href="#optional-packages"></a>
</h4>
<p>The following packages are only needed for interactive features:</p>
<ul>
<li>htmlwidgets<br>
</li>
<li>shiny</li>
</ul>
<p><br><br></p>
</div>
</div>
<div class="section level3">
<h3 id="species-and-complexes-included">2. Species and complexes included<a class="anchor" aria-label="anchor" href="#species-and-complexes-included"></a>
</h3>
<p>The following is the full list of Anopheles species and species
complexes included in the AnophelesBionomics package:</p>
<ul>
<li>Anopheles arabiensis<br>
</li>
<li>Anopheles funestus complex<br>
</li>
<li>Anopheles gambiae<br>
</li>
<li>Anopheles gambiae complex<br>
</li>
<li>Anopheles funestus<br>
</li>
<li>Anopheles nili<br>
</li>
<li>Anopheles moucheti<br>
</li>
<li>Anopheles nili complex<br>
</li>
<li>Anopheles melas<br>
</li>
<li>Anopheles gambiae (Forest)<br>
</li>
<li>Anopheles gambiae (Form M)<br>
</li>
<li>Anopheles merus<br>
</li>
<li>Anopheles nili (ovengensis)<br>
</li>
<li>Anopheles carnevalei (nili)<br>
</li>
<li>Anopheles gambiae (Form S)<br>
</li>
<li>Anopheles gambiae (Savanna)<br>
</li>
<li>Anopheles gambiae (Bamako)<br>
</li>
<li>Anopheles gambiae (Mopti)<br>
</li>
<li>Anopheles albimanus<br>
</li>
<li>Anopheles darlingi<br>
</li>
<li>Anopheles pseudopunctipennis complex<br>
</li>
<li>Anopheles nuneztovari complex<br>
</li>
<li>Anopheles albitarsis complex<br>
</li>
<li>Anopheles aquasalis<br>
</li>
<li>Anopheles albitarsis (marajoara formerly Sp C)<br>
</li>
<li>Anopheles albitarsis (Sp. E)<br>
</li>
<li>Anopheles nuneztovari(Sp. B/C)<br>
</li>
<li>Anopheles albitarsis (formerly Sp A)<br>
</li>
<li>Anopheles albitarsis (Sp. B)<br>
</li>
<li>Anopheles quadrimaculatus complex<br>
</li>
<li>Anopheles quadrimaculatus (formerly Sp. A)<br>
</li>
<li>Anopheles freeborni<br>
</li>
<li>Anopheles annularis complex<br>
</li>
<li>Anopheles culicifacies complex<br>
</li>
<li>Anopheles aconitus<br>
</li>
<li>Anopheles subpictus complex<br>
</li>
<li>Anopheles dirus complex<br>
</li>
<li>Maculatus Group<br>
</li>
<li>Anopheles minimus complex<br>
</li>
<li>Anopheles fluviatilis complex<br>
</li>
<li>Anopheles barbirostris complex<br>
</li>
<li>Anopheles maculatus<br>
</li>
<li>Anopheles barbirostris<br>
</li>
<li>Anopheles flavirostris<br>
</li>
<li>Anopheles sundaicus<br>
</li>
<li>Anopheles sundaicus complex<br>
</li>
<li>Anopheles sinensis<br>
</li>
<li>Anopheles harrisoni (formerly minimus Sp. C)<br>
</li>
<li>Anopheles dirus (formerly Sp. A)<br>
</li>
<li>Anopheles minimus (formerly Sp. A)<br>
</li>
<li>Anopheles balabacensis (leucosphyrus)<br>
</li>
<li>Anopheles stephensi<br>
</li>
<li>Anopheles anthropophagus (lesteri)<br>
</li>
<li>Anopheles baimaii (formerly dirus Sp. D)<br>
</li>
<li>Anopheles leucosphyrus<br>
</li>
<li>Anopheles cracens (formerly dirus Sp. B)<br>
</li>
<li>Anopheles fluviatilis (Sp.T)<br>
</li>
<li>Anopheles culicifacies (Sp. A)<br>
</li>
<li>Anopheles culicifacies (Sp. B)<br>
</li>
<li>Anopheles culicifacies (Sp. C)<br>
</li>
<li>Anopheles fluviatilis (Sp. S)<br>
</li>
<li>Anopheles culicifacies (Sp. D)<br>
</li>
<li>Anopheles epiroticus (formerly sundaicus Sp. A)<br>
</li>
<li>Anopheles annularis<br>
</li>
<li>Anopheles punctulatus complex<br>
</li>
<li>Anopheles farauti complex<br>
</li>
<li>Anopheles koliensis<br>
</li>
<li>Anopheles latens (leucospyrus)<br>
</li>
<li>Anopheles leucosphyrus complex<br>
</li>
<li>Anopheles subpictus (Sp. B)<br>
</li>
<li>Anopheles farauti (formerly No.1)<br>
</li>
<li>Anopheles punctulatus<br>
</li>
<li>Anopheles farauti (No. 4)<br>
</li>
<li>Anopheles farauti (No. 8)<br>
</li>
<li>Anopheles fluviatilis (Sp. U)<br>
</li>
<li>Anopheles annularis (Sp. A)<br>
</li>
<li>Anopheles culicifacies (Sp. E)<br>
</li>
<li>Anopheles splendidus<br>
</li>
<li>Anopheles subpictus<br>
</li>
<li>Anopheles nivipes<br>
</li>
<li>Anopheles pseudojamesi<br>
</li>
<li>Anopheles barbirostris s.l.<br>
</li>
<li>Anopheles dirus s.l.<br>
</li>
<li>Anopheles jamesii<br>
</li>
<li>Anopheles kochi<br>
</li>
<li>Anopheles maculatus s.l.<br>
</li>
<li>Anopheles philippinensis<br>
</li>
<li>Anopheles tessellatus<br>
</li>
<li>Anopheles vagus<br>
</li>
<li>Anopheles minimus s.l.<br>
</li>
<li>Anopheles epiroticus</li>
</ul>
</div>
<div class="section level3">
<h3 id="rules-to-add-data">3. Rules to add data<a class="anchor" aria-label="anchor" href="#rules-to-add-data"></a>
</h3>
<p>To successfully create a dataset repository using create_repo(), your
dataset must include:</p>
<ul>
<li>
<strong><code>species</code></strong> — The mosquito species name
(e.g., An. gambiae).</li>
<li>
<strong><code>insecticide_control</code></strong> — Indicates if
insecticide was present (“t” for true, “f” for false).</li>
<li>
<strong><code>country</code></strong> — The country where the data
was collected.</li>
<li>
<strong><code>year_start</code></strong> — Enables filtering by time
periods later.</li>
<li>
<strong><code>insecticide_control</code></strong> — Should be “f”
for control and “t” for intervention.</li>
</ul>
<p>Optional but recommended:</p>
<ul>
<li>
<strong><code>source_id</code></strong> — A unique identifier for
the data source or study.</li>
<li>
<strong><code>citation</code></strong> — Full citation of the
study.</li>
<li>
<strong><code>pubmed_id</code></strong> — PubMed ID related to the
study, or NA if not available.</li>
</ul>
<div class="section level4">
<h4 id="parous-rate">Parous Rate<a class="anchor" aria-label="anchor" href="#parous-rate"></a>
</h4>
<p>To calculate parous rate, your dataset must include:</p>
<ul>
<li>
<strong><code>parity_n</code></strong> — Number of parous mosquitoes
(numerator). Use NA if only percentage is available.</li>
<li>
<strong><code>parity_total</code></strong> — Total number of
mosquitoes dissected (denominator).</li>
<li>
<strong><code>parity_percent</code></strong> — Percentage; used to
estimate parity_n if needed, NA otherwise.</li>
<li>
<strong><code>insecticide_control</code></strong> — Must be
“f”.</li>
</ul>
</div>
<div class="section level4">
<h4 id="endophagy">endophagy<a class="anchor" aria-label="anchor" href="#endophagy"></a>
</h4>
<p>To calculate endophagy, your dataset must include:</p>
<ul>
<li>
<strong><code>indoor_biting_n</code></strong> — Number of mosquitoes
biting indoors. Use NA if only percentage is available.</li>
<li>
<strong><code>indoor_biting_total</code></strong> — Total mosquitoes
biting (indoor + outdoor).</li>
<li>
<strong><code>indoor_biting</code></strong> — Percentage; used to
estimate indoor_biting_n if needed, NA otherwise.</li>
<li>
<strong><code>indoor_biting_sampling</code></strong> — Must be
“MBI”.</li>
<li>
<strong><code>outdoor_biting_sampling</code></strong> — Must be
“MBO”.</li>
<li>
<strong><code>HLC_same</code></strong> — Must be TRUE, indicating
same design indoors and outdoors.</li>
<li>
<strong><code>insecticide_control</code></strong> — Must be
“f”.</li>
</ul>
</div>
<div class="section level4">
<h4 id="endophily">endophily<a class="anchor" aria-label="anchor" href="#endophily"></a>
</h4>
<p>To calculate endophily, your dataset must include:</p>
<ul>
<li>
<strong><code>indoor_fed</code></strong> — Number of mosquitoes fed
indoors.</li>
<li>
<strong><code>outdoor_fed</code></strong> — Number fed
outdoors.</li>
<li>
<strong><code>resting_unit</code></strong> — Must be either “%” or
“count”.</li>
</ul>
<p>If resting_unit is “%”, also include:</p>
<ul>
<li>
<strong><code>indoor_total</code></strong> — Total mosquitoes
observed indoors.</li>
<li>
<strong><code>outdoor_total</code></strong> — Total mosquitoes
observed outdoors.</li>
</ul>
<p>Additional required fields:</p>
<ul>
<li>
<strong><code>indoor_resting_sampling</code></strong> — Must be
“HRI”.</li>
<li>
<strong><code>outdoor_resting_sampling</code></strong> — Must be
“WinExit”.</li>
<li>
<strong><code>WinExit_in_HRI_houses</code></strong> — Must be
TRUE.</li>
<li>
<strong><code>insecticide_control</code></strong> — Must be
“t”.</li>
</ul>
<p>Optionally, if reconstructing totals:</p>
<ul>
<li>
<strong><code>indoor_unfed</code></strong>,
<strong><code>indoor_gravid</code></strong>
</li>
<li>
<strong><code>outdoor_unfed</code></strong>,
<strong><code>outdoor_gravid</code></strong>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="sac-rate">sac rate<a class="anchor" aria-label="anchor" href="#sac-rate"></a>
</h4>
<p>To calculate sac rate, your dataset must include:</p>
<ul>
<li>
<strong><code>parous_with_sac</code></strong> — Number of parous
mosquitoes with sac (numerator).</li>
<li>
<strong><code>parous</code></strong> — Total number of parous
mosquitoes (denominator).</li>
<li>
<strong><code>sac_rate_percent</code></strong> — Percentage; used to
estimate parous_with_sac if needed, NA otherwise.</li>
<li>
<strong><code>insecticide_control</code></strong> — Must be
“t”.</li>
</ul>
</div>
<div class="section level4">
<h4 id="hbi">HBI<a class="anchor" aria-label="anchor" href="#hbi"></a>
</h4>
<p>To calculate indoor human blood index (indoor HBI), your dataset must
include:</p>
<ul>
<li>
<strong><code>indoor_host_sampling</code></strong> — Must be one of
“HRI”, “ILT”, or “WinExit”.</li>
<li>
<strong><code>indoor_host_n</code></strong> — Number of mosquitoes
feeding on humans indoors.</li>
<li>
<strong><code>indoor_host_total</code></strong> — Total mosquitoes
tested indoors.</li>
<li>
<strong><code>indoor_host</code></strong> — Percentage; used to
estimate indoor_host_n if needed, NA otherwise.</li>
<li>
<strong><code>host_unit</code></strong> — Must NOT be “AI” (animal
index).</li>
<li>
<strong><code>insecticide_control</code></strong> — Must be
“f”.</li>
</ul>
<p>To calculate outdoor human blood index (outdoor HBI), your dataset
must include:</p>
<ul>
<li>
<strong><code>outdoor_host_sampling</code></strong> — Must be one of
“RO”, “RO (shelter)”, “RO (pit)”, or “WinExit”.</li>
<li>
<strong><code>outdoor_host_n</code></strong> — Number of mosquitoes
feeding on humans outdoors.</li>
<li>
<strong><code>outdoor_host_total</code></strong> — Total mosquitoes
tested outdoors.</li>
<li>
<strong><code>outdoor_host</code></strong> — Percentage; used to
estimate outdoor_host_n if needed, NA otherwise.</li>
<li>
<strong><code>host_unit</code></strong> — Must NOT be “AI” (animal
index).</li>
<li>
<strong><code>insecticide_control</code></strong> — Must be
“f”.</li>
</ul>
<p>If you have combined host sampling (no separation between indoor and
outdoor), your dataset must also, as well that the precedente colomns
include:</p>
<ul>
<li>
<strong><code>combined_host_sampling_1</code></strong> — Main
sampling method used, must be valid.</li>
<li>
<strong><code>combined_host_n</code></strong> — Number of mosquitoes
feeding on humans.</li>
<li>
<strong><code>combined_host_total</code></strong> — Total mosquitoes
tested.</li>
<li>
<strong><code>combined_host</code></strong> — Percentage; used to
estimate combined_host_n if needed, NA otherwise.</li>
<li>
<strong><code>combined_host_sampling_n</code></strong> — Must NOT be
“t”.</li>
<li>
<strong><code>insecticide_control</code></strong> — Must be
“f”.</li>
</ul>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Aurélien Tarroux.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
